

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>2.2.1. Generic Image Classifier &mdash; BRAILS 2.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
        <script src="../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.2.2. PyTorch Image Classifier" href="pytorchImageClassifier.html" />
    <link rel="prev" title="2.2. Modules" href="modules.html" />
<script src="https://cdn.jsdelivr.net/npm/vega@5.12.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.13.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.8.0"></script>
<style media="screen">.vega-actions a {margin-right: 5px;}</style>
<link href="../../../_static/css/bootstrap.css" rel="stylesheet">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F2F2F2" >
          
<a href="https://simcenter.designsafe-ci.org/" style="margin-bottom: 0px;">
  <img src="../../../_static/SimCenter_logo.png" class="logo" alt="Org-Logo" />
</a>
<hr style="margin: 0px;">

  <a href="../../../index.html">


  <img src="../../../_static/SimCenter_BRAILS_logo_solo.png" class="logo" alt="Logo"/>
</a>


  
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/about.html">1. About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/acknowledgements.html">2. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/license.html">3. Copyright and License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/cite.html">4. How to Cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/glossary.html">5. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/abbreviations.html">6. Abbreviations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/releasenotes.html">7. Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../userGuide.html">2. User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../dataPrep.html">2.1. Data Preperation for Training and Inference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="modules.html">2.2. Modules</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.2.1. Generic Image Classifier</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#decription">2.2.1.1. Decription</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">2.2.1.2. Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#construct-the-image-classifier">2.2.1.3. Construct the image classifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="#train-the-model">2.2.1.4. Train the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classify-images-based-on-model">2.2.1.5. Classify Images Based on Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pytorchImageClassifier.html">2.2.2. PyTorch Image Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="roofClassifier.html">2.2.3. Roof Shape Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="occupancyClassifier.html">2.2.4. Occupancy Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="nFloorDetector.html">2.2.5. Number of Floors Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="yearClassifier.html">2.2.6. Year Built Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="foundationElevationClassifier.html">2.2.7. Raised Foundation Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="garageDetector.html">2.2.8. Garage Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="chimneyDetector.html">2.2.9. Chimney Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="softstoryClassifier.html">2.2.10. Soft-story Building Classifier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../workflow.html">2.3. Workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">3. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">4. Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">5. Bugs &amp; Feature Requests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../technical_manual/theory.html">1. Theory and Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_manual/vnv.html">2. Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_manual/understand.html">3. Generalization</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">BRAILS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../userGuide.html"><span class="section-number">2. </span>User Guide</a> &raquo;</li>
        
          <li><a href="modules.html"><span class="section-number">2.2. </span>Modules</a> &raquo;</li>
        
      <li><span class="section-number">2.2.1. </span>Generic Image Classifier</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/common/user_manual/modules/genericImageClassifier.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="generic-image-classifier">
<span id="lbl-genericimageclassifier"></span><h1><span class="section-number">2.2.1. </span>Generic Image Classifier<a class="headerlink" href="#generic-image-classifier" title="Permalink to this headline">Â¶</a></h1>
<p>The Generic Image Classifier is a class that can be used for creating user defined classifier.</p>
<div class="toggle docutils container">
<div class="header docutils container">
<p><strong>Methods</strong></p>
</div>
<ol class="arabic simple">
<li><p><strong>init</strong></p>
<ol class="arabic simple">
<li><p><strong>modelName</strong> Path to model</p></li>
<li><p><strong>classNames</strong> List of class names</p></li>
<li><p><strong>resultFile</strong> default = preds.csv</p></li>
<li><p><strong>workDir</strong> default = tmp</p></li>
<li><p><strong>printRes</strong> default=True</p></li>
</ol>
</li>
<li><p>train</p></li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>baseModel</strong>: default=âInceptionV3â</p></li>
<li><p><strong>lr1</strong>: default=0.0001</p></li>
<li><p><strong>initial_epochs</strong>: default==10,</p></li>
<li><p><strong>fine_tune_at</strong>: default==300,</p></li>
<li><p><strong>lr2</strong>: default=0.00001,</p></li>
<li><p><strong>fine_tune_epochs:</strong> default==50,</p></li>
<li><p><strong>color_mode default</strong>: =ârgbâ,</p></li>
<li><p><strong>horizontalFlip</strong>: default=False,</p></li>
<li><p><strong>verticalFlip</strong>: default=False,</p></li>
<li><p><strong>dropout</strong>: default=0.6</p></li>
<li><p><strong>randomRotation</strong>: default=0.0,</p></li>
<li><p><strong>callbacks</strong>: default==[],</p></li>
<li><p><strong>plot</strong>: default==True</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple">
<li><p><strong>predict</strong></p>
<ol class="arabic simple">
<li><p><strong>image</strong>: single image or list of images</p></li>
<li><p><strong>color_mode</strong>: default=ârgbâ</p></li>
</ol>
</li>
<li><p>loadData</p></li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>imgDir</strong>:</p></li>
<li><p><strong>valimgDir</strong>: default=ââ</p></li>
<li><p><strong>randomseed</strong>: default=1993,</p></li>
<li><p><strong>color_mode</strong> default=ârgbâ,</p></li>
<li><p><strong>image_size</strong> default=(256, 256),</p></li>
<li><p><strong>batch_size</strong>: default = 32,</p></li>
<li><p><strong>split</strong>: default=[0.8,0.2]):</p></li>
</ol>
</div></blockquote>
</div>
<div class="section" id="decription">
<h2><span class="section-number">2.2.1.1. </span>Decription<a class="headerlink" href="#decription" title="Permalink to this headline">Â¶</a></h2>
<p>This class implements the abstraction of an image classifier, it can be first used to train the classifier and save the data needed by the classifier locally. Once trained, the classifier can be used to predict the class of each image given a set of images. The user provides categorized images to the classifier so that it can be initially trained.</p>
</div>
<div class="section" id="example">
<h2><span class="section-number">2.2.1.2. </span>Example<a class="headerlink" href="#example" title="Permalink to this headline">Â¶</a></h2>
<p>The following is an example, in which a classifier is created and trained.</p>
<p>The image dataset for this example contains street view images categorized according to construction materials.</p>
<p>The dataset can be downloaded <a class="reference external" href="https://zenodo.org/record/4416845/files/building_materials.zip">here</a>.</p>
<p>When unzipped, the file gives the âbuilding_materialsâ which is a directory that contains the images for training:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>building_materials
âââ class_1
â       âââ *.png
âââ class_2
|      âââ *.png
âââ ...
|
âââ class_n
       âââ *.png
</pre></div>
</div>
</div>
<div class="section" id="construct-the-image-classifier">
<h2><span class="section-number">2.2.1.3. </span>Construct the image classifier<a class="headerlink" href="#construct-the-image-classifier" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># import the module
from brails.modules import ImageClassifier

# initialize the classifier, give it a name
materialClassifier = ImageClassifier(modelName=&#39;materialClassifierV0.1&#39;)

# load data
materialClassifier.loadData(&#39;building_materials&#39;)
</pre></div>
</div>
</div>
<div class="section" id="train-the-model">
<h2><span class="section-number">2.2.1.4. </span>Train the model<a class="headerlink" href="#train-the-model" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># train the base model for 50 epochs and then fine tune for 200 epochs
materialClassifier.train(baseModel=&#39;InceptionV3&#39;, initial_epochs=50,fine_tune_epochs=200)
</pre></div>
</div>
<p>It is recommended to run the above example on a GPU machine.</p>
<p>The following ML model training options are available for selection as the baseModel key:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;Xception&#39;,
&#39;VGG16&#39;,
&#39;VGG19&#39;,
&#39;ResNet50&#39;,
&#39;ResNet101&#39;,
&#39;ResNet152&#39;,
&#39;ResNet50V2&#39;,
&#39;ResNet101V2&#39;,
&#39;ResNet152V2&#39;,
&#39;InceptionV3&#39;,
&#39;InceptionResNetV2&#39;,
&#39;MobileNet&#39;,
&#39;MobileNetV2&#39;,
&#39;DenseNet121&#39;,
&#39;DenseNet169&#39;,
&#39;DenseNet201&#39;,
&#39;NASNetMobile&#39;,
&#39;NASNetLarge&#39;,
&#39;EfficientNetB0&#39;,
&#39;EfficientNetB1&#39;,
&#39;EfficientNetB2&#39;,
&#39;EfficientNetB3&#39;,
&#39;EfficientNetB4&#39;,
&#39;EfficientNetB5&#39;,
&#39;EfficientNetB6&#39;,
&#39;EfficientNetB7&#39;
</pre></div>
</div>
</div>
<div class="section" id="classify-images-based-on-model">
<h2><span class="section-number">2.2.1.5. </span>Classify Images Based on Model<a class="headerlink" href="#classify-images-based-on-model" title="Permalink to this headline">Â¶</a></h2>
<p>Now you can use the trained model to predict the (building materials) class for a given image.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># If you are running the inference from another place, you need to initialize the classifier firstly:
from brails.GenericImageClassifier import ImageClassifier
materialClassifier = ImageClassifier(modelName=&#39;materialClassifierV0.1&#39;)

# define the paths of images in a list
imgs = [&#39;building_materials/concrete/469 VAN BUREN AVE Oakland2.jpg&#39;,
        &#39;building_materials/masonry/101 FAIRMOUNT AVE Oakland2.jpg&#39;,
        &#39;building_materials/wood/41 MOSS AVE Oakland2.jpg&#39;]

# use the model to predict
predictions = materialClassifier.predict(imgs)
</pre></div>
</div>
<p>The predictions will be written in preds.csv under the current directory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The generic image classifier is intended to illustrate the overall process of model training and prediction.
The classifier takes an image as the input and will always produce a prediction.
Since the classifier is trained to classify only a specific category of images, its prediction is meaningful only if
the input image belongs to the category the model is trained for.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="pytorchImageClassifier.html" class="btn btn-neutral float-right" title="2.2.2. PyTorch Image Classifier" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="modules.html" class="btn btn-neutral float-left" title="2.2. Modules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, The Regents of the University of California.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>